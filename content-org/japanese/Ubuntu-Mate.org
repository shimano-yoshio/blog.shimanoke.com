#+TITLE: Ubuntu Mate Tips
#+LANGUAGE: ja
#+AUTHOR: 島野 善雄
#+EMAIL: shimano.yoshio@gmail.com
# 出版した日付
#+date: <2023-08-31 Thu>
# 更新日を自動的につける
#+hugo_auto_set_lastmod: t
# 見出しをレベル 6 まで出す
#+OPTIONS: H:6 num:nil
#+OPTIONS: toc:1
#+STARTUP: indent
#+hugo_type: post
# 出力するディレクトリ
#+hugo_base_dir: ../..
# 出版するファイル名
#+hugo_section: japanese/docs
#+OPTIONS: creator:nil author:t
#+LANGUAGE: ja
# Hugo のタグ
#+filetags: Ubuntu "Ubuntu MATE"
# Hugo のカテゴリー
#+hugo_categories: Ubuntu
# #+hugo_custom_front_matter: :thumbnail images/org-to-hugo.svg



* DONE スクリーン上にキーストロークを表示する (Ubuntu 23.04)
CLOSED: [2023-09-03 Sun 12:41]
:PROPERTIES:
:EXPORT_DATE: <2023-09-02 Sat>
:EXPORT_HUGO_SECTION: japanese/posts
:EXPORT_FILE_NAME: show-key-on-screen-mate
:EXPORT_OPTIONS: toc:t num:t
:END:
:LOGBOOK:
- State "DONE"       from "TODO"       [2023-09-03 Sun 12:41]
CLOCK: [2023-09-03 Sun 09:56]
:END:

ときどき、プレゼンテーションの間のように、
キーストロークを画面に表示したいことがあります。

このために、私は [[https://www.thregr.org/wavexx/software/screenkey/][screenkey]] を使っていあます。

- [[https://www.thregr.org/wavexx/software/screenkey/][Screencast your keys.]]

この記事では、
Screenkey のインストール/セットアップ方法を示します。

** 環境

- OS: Ubuntu Mate 23.04 on VirtualBox] on Windows 11.


** screenkey のインストール

Screenky を Ubuntu にインストールするには、
これをターミナルの中でタイプします:

#+caption: Install Screenkye
#+begin_src sh :eval no
sudo apt -y install screenkey
#+end_src

** Screnkye をはじめる
次に
screenkey をターミナルからはじめます:

#+caption: Start Screenkey
#+begin_src sh :eval no
screenkey
#+end_src

その後で screenkey アイコンが
メインメニュー上に表示されます:

#+attr_html: :alt Screenkye Icon on Main Menu
#+ATTR_HTML: :width 50% :style float:center;border:2px solid black;
#+caption: Screenkye のアイコン
[[file:~/Documents/blog.shimanoke.com/content-org/japanese/images/screenshot-menu.png]]

"Preferences" を選択して、
自分の好みに設定してください。

#+attr_html: :alt Screenkey の設定
#+ATTR_HTML: :width 50% :style border:2px solid black;
#+caption: Screenkey の設定
[[file:~/Documents/blog.shimanoke.com/content-org/japanese/images/screenky-prefs.png]]


... そうすると、キーストロークがスクリーン上に
表示されることがわかります。

#+attr_html: :al Screenkey の動いている様子
#+ATTR_HTML: :width 50% :style border:2px solid black;
#+caption: Screenkey の動いている様子
[[file:~/Documents/blog.shimanoke.com/content-org/japanese/images/screenkye.gif]]







* DONE peco を使って zsh でコマンド履歴を便利にする
:PROPERTIES:
:EXPORT_DATE: <2023-08-31 Thu>
:EXPORT_HUGO_SECTION: japanese/posts
:EXPORT_FILE_NAME: use-peco-in-zsh
:EXPORT_OPTIONS: toc:t num:t
:END:
:LOGBOOK:
- State "DONE"       from              [2023-09-03 Sun 09:54]
:END:

私はシェルとして Zsh を使っています。
Zsh はコマンド補完がありますが、peco を使うと、
コマンドの履歴を便利に選択することができます。

- [[https://github.com/peco/peco][peco/peco: Simplistic interactive filtering tool]]

下の図では =apt= とタイプした後に =Ctl-r" をタイプしています。
コマンド補完の候補が出てくるのがわかります。

ここでコマンドを選択するために Emacs のキーバインディングを
使うことができます。


#+caption: peco を起動した情愛
[[file:images/peco-samoke.png]]

** この文書の設定できること

- コマンド履歴の検索 (Ctl+r)
- cd の履歴の検索 (Ctl+f)

** 参考文献


以下のサイトを参考にさせていただきました。

- [[https://github.com/peco/peco][peco/peco: Simplistic interactive filtering tool]] : peco 本家
- [[https://www.wakuwakubank.com/posts/862-mac-zsh-peco/][Mac | zshとpecoでコマンド入力作業を快適に - わくわくBank]] : zsh から
  peco を使う方法が詳しくのっています。
** 確認環境
確認した環境です。
私は Ubuntu MATE を使っていますが、Windows でも動くようです。

- Host OS : Windows11 Pro
- Guest OS : Ubuntu Mate 23.04 on VirtualBox

** peco のインストール

peco をインストールするには次のようにします:

#+caption: peco の Ubuntu  へのインストール
#+begin_src sh
sudo apt -y install peco
#+end_src

** Zsh で peco を使うための設定

=~/.zshrc= に以下を追加します。

#+caption: Zsh で peco を使うための設定
#+begin_src sh
# ---------------------------------------
# peco
# https://www.instagram.com/pecotecooo/?hl=en
# ---------------------------------------

# A function for command history (Ctl-r)
function peco-select-history() {
    local tac
    if which tac > /dev/null; then
        tac="tac"
    else
        tac="tail -r"
    fi
    BUFFER=$(\history -n 1 | \
        eval $tac | \
        peco --query "$LBUFFER")
    CURSOR=$#BUFFER
    zle clear-screen1
}
zle -N peco-select-history
bindkey '^r' peco-select-history

# Setup cdr
if [[ -n $(echo ${^fpath}/chpwd_recent_dirs(N)) && -n $(echo ${^fpath}/cdr(N)) ]]; then
    autoload -Uz chpwd_recent_dirs cdr add-zsh-hook
    add-zsh-hook chpwd chpwd_recent_dirs
    zstyle ':completion:*' recent-dirs-insert both
    zstyle ':chpwd:*' recent-dirs-default true
    zstyle ':chpwd:*' recent-dirs-max 1000
fi

# cd history (Ctrl+f)
function peco-cdr () {
    local selected_dir="$(cdr -l | sed 's/^[0-9]\+ \+//' | peco --prompt="cdr >" --query "$LBUFFER")"
    if [ -n "$selected_dir" ]; then
        BUFFER="cd ${selected_dir}"
        zle accept-line
    fi
}
zle -N peco-cdr
bindkey '^f' peco-cdr
# ---------------------------------------
#+end_src


** 使用方法

- コマンド履歴の検索 (Ctl+r)
- cd の履歴の検索 (Ctl+f)


